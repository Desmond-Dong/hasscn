"use strict";var u=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var c=Object.prototype.hasOwnProperty;var f=(e,t)=>{for(var i in t)u(e,i,{get:t[i],enumerable:!0})},h=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of d(t))!c.call(e,s)&&s!==i&&u(e,s,{get:()=>t[s],enumerable:!(r=p(t,s))||r.enumerable});return e};var g=e=>h(u({},"__esModule",{value:!0}),e);var S={};f(S,{default:()=>m});module.exports=g(S);var a=require("node:fs"),n=require("node:path");const y=e=>{let t="<url>";for(const[i,r]of Object.entries(e))t+=`<${i}>${r}</${i}>`;return t+="</url>",t},P=e=>(console.log(`Generate sitemap.xml for ${e.length} pages.`),`<?xml version="1.0" encoding="UTF-8"?><urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">${e.reduce((t,i)=>t+y(i),"")}</urlset>`);function m(e){e={domain:"https://rspress.dev",customMaps:{},defaultChangeFreq:"monthly",defaultPriority:"0.5",...e};let t=[],i=new Set;return{name:"rspress-plugin-sitemap",config(r){return r},extendPageData(r,s){s&&(i.has(r.routePath)||(i.add(r.routePath),t.push({loc:`${e.domain}${r.routePath}`,lastmod:(0,a.statSync)(r._filepath).mtime.toISOString(),priority:r.routePath==="/"?"1.0":e.defaultPriority,changefreq:e.defaultChangeFreq,...e.customMaps&&e.customMaps[r.routePath]||{}})))},afterBuild(r,s){if(s){const o=r.outDir||r.builderConfig?.output?.distPath?.root;let l=`./${o||"doc_build"}/sitemap.xml`;(0,n.isAbsolute)(o||"")&&(l=`${o}/sitemap.xml`),(0,a.mkdirSync)((0,n.dirname)(l),{recursive:!0}),(0,a.writeFileSync)(l,P(t))}}}}
